"use strict";angular.module("worldApp",["ngAnimate","ngRoute"]).config(function(o){o.when("/",{templateUrl:"templates/home.html"}).when("/countries",{templateUrl:"templates/countries.html",controller:"countryListCtrl"}).when("/countries/:countryCode/:countryCapital",{templateUrl:"templates/country.html",controller:"countryCtrl"}).otherwise({redirectTo:"/"})}).run(function(o,e){o({method:"POST",url:"http://api.geonames.org/countryInfoJSON",cache:!0,params:{username:"merf64"}}).success(function(o){e.countriesList=[];for(var n=0;n<o.geonames.length;n++)e.countriesList[n]=o.geonames[n];e.$broadcast("countriesLoaded")})}).controller("countryCtrl",function(o,e,n,t,r,a){o.loading=!0,o.countryCode=e.countryCode,o.countryCapital=e.countryCapital,o.$on("countriesLoaded",function(){t.countriesList&&(n({method:"POST",url:"http://api.geonames.org/countryInfoJSON",cache:!0,params:{username:"merf64",country:o.countryCode}}).success(function(e){e.geonames[0]&&(o.countryName=e.geonames[0].countryName,o.countryPop=e.geonames[0].population,o.areaInSqKm=e.geonames[0].areaInSqKm,o.countryCapital=e.geonames[0].capital),n({method:"POST",url:"http://api.geonames.org/searchJSON",params:{username:"merf64",country:o.countryCode,name_equals:o.countryCapital}}).success(function(e){o.capitalPop=e.geonames[0]?e.geonames[0].population:"Unknown"})}),n({method:"POST",url:"http://api.geonames.org/neighboursJSON",params:{username:"merf64",country:o.countryCode}}).success(function(e){if(o.neighborsList=[],e.geonames)for(var n=0;n<e.geonames.length;n++)o.neighborsList[n]=e.geonames[n]}),a(function(){o.loading=!1},1e3))}),t.$broadcast("countriesLoaded"),o.loadNeighbor=function(o){r.url("/countries/"+o+"/unknown")}}).controller("countryListCtrl",function(o,e){e.loadCountry=function(e,n){o.url("/countries/"+e+"/"+n)}});